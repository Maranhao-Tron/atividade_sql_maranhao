/* SQL SCRIPT - ATIVIDADE SQL + FIREBIRD */

/* CRIAÇÃO DE TABELAS */
CREATE TABLE PRODUTOS (
	PRO_CODIGO INTEGER PRIMARY KEY,
	PRO_NOME VARCHAR(30) UNIQUE,
	PRO_DESC VARCHAR(60),
	PRO_PRECO_CUSTO NUMERIC(8,2),
	PRO_PRECO_VENDA NUMERIC(8,2),
	PRO_QTD INTEGER,
	PRO_FORNECEDOR VARCHAR(30)
);

CREATE TABLE CLIENTES (
	CLI_ID INTEGER PRIMARY KEY,
	CLI_NOME VARCHAR(30),
	CLI_CPF_CNPJ VARCHAR(11) UNIQUE,
	CLI_ENDEDERCO VARCHAR(60),
	CLI_TELEFONE VARCHAR(13),
	CLI_EMAIL VARCHAR(30) UNIQUE,
	CLI_DT_NASC DATE
);

CREATE TABLE VENDAS (
	VEN_COD VARCHAR(9) PRIMARY KEY,
	VEN_DATA DATE,
	VEN_CLIENTE_ID INTEGER UNIQUE,
	VEN_VENDEDOR VARCHAR(30),
	VEN_PROD VARCHAR(30),
	VEN_COD_PROD INTEGER,
	VEN_QTD INTEGER,
	VEN_VALOR_TOTAL NUMERIC(8,2),
	VEN_DESCONTO NUMERIC(8,2),
	VEN_FORMA_PGTO VARCHAR(20)
);

CREATE TABLE COMPRAS (
	CMP_ID INTEGER PRIMARY KEY,
	CMP_DATA DATE,
	CMP_FORNECEDOR VARCHAR(30),
	CMP_PROD VARCHAR(30),
	CMP_COD_PROD INTEGER,
	CMP_QTD INTEGER,
	CMP_FORMA_PGTO VARCHAR(20),
	CMP_PRAZO_ENTREGA VARCHAR(30)
);

CREATE TABLE USERS (
	USER_ID INTEGER PRIMARY KEY,
	USER_NAME VARCHAR(30),
	USER_EMAIL VARCHAR(30),
	USER_ACTIVE SMALLINT NOT NULL CHECK (USER_ACTIVE IN (0, 1)),
	USER_PERM_ID INTEGER,
	USER_PASSWORD VARCHAR(60) UNIQUE
)

ALTER TABLE VENDAS
ADD CONSTRAINT FK_CLI_ID
FOREIGN KEY (VEN_CLIENTE_ID)
REFERENCES CLIENTES (CLI_ID)

ALTER TABLE COMPRAS
ADD CONSTRAINT FK_COD_PRODUTO
FOREIGN KEY (CMP_COD_PROD)
REFERENCES PRODUTOS (PRO_CODIGO)

ALTER TABLE COMPRAS
ADD CONSTRAINT FK_NOME_PRODUTO
FOREIGN KEY (CMP_PROD)
REFERENCES PRODUTOS (PRO_NOME)